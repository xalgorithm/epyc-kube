# PHP Configuration for WordPress
apiVersion: v1
kind: ConfigMap
metadata:
  name: php-config
  namespace: ethosenv
  labels:
    app: wordpress
data:
  # Custom PHP configuration for file uploads
  uploads.ini: |
    ; File upload settings
    upload_max_filesize = 32M
    post_max_size = 32M
    max_execution_time = 300
    max_input_time = 300
    memory_limit = 256M
    
    ; Additional PHP settings for WordPress
    max_input_vars = 3000
    file_uploads = On
    
    ; Error reporting (adjust for production)
    display_errors = Off
    log_errors = On
    error_log = /var/log/php_errors.log
  
  # PHP-FPM configuration for process management
  www.conf: |
    [www]
    user = www-data
    group = www-data
    
    listen = 127.0.0.1:9000
    listen.owner = www-data
    listen.group = www-data
    listen.mode = 0660
    
    ; Process management settings
    pm = dynamic
    pm.max_children = 100
    pm.start_servers = 4
    pm.min_spare_servers = 2
    pm.max_spare_servers = 9
    pm.max_requests = 1000
    
    ; Performance tuning
    pm.process_idle_timeout = 10s
    pm.status_path = /status
    ping.path = /ping
    
    ; Logging
    access.log = /proc/self/fd/2
    catch_workers_output = yes
    decorate_workers_output = no
    
    ; Security
    security.limit_extensions = .php .phar
  
  # .htaccess configuration for WordPress upload limits
  htaccess-uploads: |
    # WordPress upload size limits
    php_value upload_max_filesize 32M
    php_value post_max_size 32M
    php_value max_execution_time 300
    php_value max_input_time 300
    php_value memory_limit 256M
    php_value max_input_vars 3000